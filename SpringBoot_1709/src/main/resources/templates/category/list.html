<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: layout}">
  <body>
    <div th:fragment="content">
      <!-- Page Header -->
      <div class="row mb-4">
        <div class="col-md-6">
          <h1 class="page-title">
            <i class="fas fa-tags me-3"></i>
            Quản lý danh mục
          </h1>
          <p class="text-muted">Quản lý các danh mục sản phẩm trong hệ thống</p>
        </div>
        <div class="col-md-6 text-md-end">
          <a th:href="@{/categories/add}" class="btn btn-primary btn-lg">
            <i class="fas fa-plus me-2"></i>
            Thêm danh mục mới
          </a>
        </div>
      </div>

      <!-- Search -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-body">
              <form th:action="@{/categories}" method="get" class="row g-3">
                <div class="col-md-8">
                  <div class="input-group">
                    <span class="input-group-text">
                      <i class="fas fa-search"></i>
                    </span>
                    <input
                      type="text"
                      name="keyword"
                      th:value="${keyword}"
                      class="form-control"
                      placeholder="Tìm kiếm danh mục theo tên..."
                    />
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="d-grid">
                    <button type="submit" class="btn btn-outline-primary">
                      <i class="fas fa-search me-2"></i>
                      Tìm kiếm
                    </button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>

      <!-- Categories Table -->
      <div class="row">
        <div class="col-12">
          <div class="card">
            <div
              class="card-header d-flex justify-content-between align-items-center"
            >
              <h5 class="mb-0">
                <i class="fas fa-list me-2"></i>
                Danh sách danh mục
                <span
                  class="badge bg-primary ms-2"
                  th:text="${categories.totalElements}"
                  >0</span
                >
              </h5>
            </div>
            <div class="card-body p-0">
              <div class="table-responsive">
                <table class="table table-hover mb-0">
                  <thead>
                    <tr>
                      <th width="100">ID</th>
                      <th>Tên danh mục</th>
                      <th>Hình ảnh</th>
                      <th width="120">Trạng thái</th>
                      <th width="200">Hành động</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr th:each="category, iterStat : ${categories}">
                      <td>
                        <span
                          class="badge bg-light text-dark"
                          th:text="${category.categoryId}"
                          >1</span
                        >
                      </td>
                      <td>
                        <div class="d-flex align-items-center">
                          <div class="me-3">
                            <i class="fas fa-folder text-primary"></i>
                          </div>
                          <div>
                            <h6 class="mb-0" th:text="${category.categoryName}">
                              Tên danh mục
                            </h6>
                            <small class="text-muted">Danh mục sản phẩm</small>
                          </div>
                        </div>
                      </td>
                      <td>
                        <div
                          th:if="${category.categoryImage != null and !#strings.isEmpty(category.categoryImage)}"
                        >
                          <img
                            th:src="${category.categoryImage}"
                            th:alt="${category.categoryName}"
                            class="img-thumbnail"
                            style="
                              width: 60px;
                              height: 60px;
                              object-fit: cover;
                              border-radius: 8px;
                            "
                            onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjYwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0yMCAyMEg0MFY0MEgyMFYyMFoiIGZpbGw9IiM5Q0E0QUYiLz4KPHBhdGggZD0iTTI1IDI1SDM1VjM1SDI1VjI1WiIgZmlsbD0iI0QxRDVEQyIvPgo8L3N2Zz4K'"
                          />
                        </div>
                        <div
                          th:unless="${category.categoryImage != null and !#strings.isEmpty(category.categoryImage)}"
                        >
                          <div
                            class="bg-light d-flex align-items-center justify-content-center"
                            style="
                              width: 60px;
                              height: 60px;
                              border-radius: 8px;
                            "
                          >
                            <i class="fas fa-image text-muted"></i>
                          </div>
                        </div>
                      </td>
                      <td>
                        <span class="badge bg-success">
                          <i class="fas fa-check-circle me-1"></i>
                          Hoạt động
                        </span>
                      </td>
                      <td>
                        <div class="btn-group" role="group">
                          <a
                            th:href="@{/categories/edit/{id}(id=${category.categoryId})}"
                            class="btn btn-warning btn-sm"
                            title="Chỉnh sửa"
                          >
                            <i class="fas fa-edit"></i>
                          </a>
                          <a
                            th:href="@{/categories/delete/{id}(id=${category.categoryId})}"
                            class="btn btn-danger btn-sm"
                            title="Xóa"
                            onclick="return confirm('Bạn có chắc chắn muốn xóa danh mục này?')"
                          >
                            <i class="fas fa-trash"></i>
                          </a>
                        </div>
                      </td>
                    </tr>
                    <tr th:if="${categories.isEmpty()}">
                      <td colspan="5" class="text-center py-5">
                        <div>
                          <i class="fas fa-inbox fa-3x text-muted mb-3"></i>
                          <h5 class="text-muted">Chưa có danh mục nào</h5>
                          <p class="text-muted">
                            Hãy thêm danh mục đầu tiên để bắt đầu
                          </p>
                          <a
                            th:href="@{/categories/add}"
                            class="btn btn-primary"
                          >
                            <i class="fas fa-plus me-2"></i>
                            Thêm danh mục
                          </a>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Pagination -->
      <div class="row mt-4" th:if="${!categories.isEmpty()}">
        <div class="col-12">
          <nav aria-label="Page navigation">
            <ul class="pagination justify-content-center">
              <li
                class="page-item"
                th:classappend="${categories.first ? 'disabled' : ''}"
              >
                <a
                  class="page-link"
                  th:href="@{/categories(page=${categories.number - 1}, keyword=${keyword})}"
                  th:if="${!categories.first}"
                >
                  <i class="fas fa-chevron-left me-1"></i>
                  Trước
                </a>
                <span class="page-link" th:if="${categories.first}">
                  <i class="fas fa-chevron-left me-1"></i>
                  Trước
                </span>
              </li>

              <li
                class="page-item"
                th:each="i : ${#numbers.sequence(0, categories.totalPages - 1)}"
                th:classappend="${i == categories.number ? 'active' : ''}"
              >
                <a
                  class="page-link"
                  th:href="@{/categories(page=${i}, keyword=${keyword})}"
                  th:text="${i + 1}"
                  >1</a
                >
              </li>

              <li
                class="page-item"
                th:classappend="${categories.last ? 'disabled' : ''}"
              >
                <a
                  class="page-link"
                  th:href="@{/categories(page=${categories.number + 1}, keyword=${keyword})}"
                  th:if="${!categories.last}"
                >
                  Sau
                  <i class="fas fa-chevron-right ms-1"></i>
                </a>
                <span class="page-link" th:if="${categories.last}">
                  Sau
                  <i class="fas fa-chevron-right ms-1"></i>
                </span>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </body>
</html>
